<!DOCTYPE html>
<!--
    Basically Basic Jekyll Theme 1.3.1
    Copyright 2017-2018 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/jekyll-basically-theme/blob/master/LICENSE.md
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
    <title>Musings of a Software Development Manager</title>
    <meta name="description" content="lessons learned managing developers">
    <link rel="canonical" href="https://edgibbs.com/">
  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/assets/stylesheets/main.css">
  

  
    
    <link rel="alternate" type="application/atom+xml" title="Musings of a Software Development Manager" href="/feed.xml">
  
</head>


  <body class="layout--home ">

    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>


    <div class="sidebar-toggle-wrapper">
      

      <button class="toggle navicon-button larr" type="button">
        <span class="toggle-inner">
          <span class="sidebar-toggle-label visually-hidden">Menu</span>
          <span class="navicon"></span>
        </span>
      </button>
    </div>

    <div id="sidebar" class="sidebar">
      <div class="inner">
        <nav id="primary-nav" class="site-nav" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation">
  <ul id="menu-main-navigation" class="menu">
    <!-- Home link -->
    <li class="menu-item">
      <a href="/" itemprop="url">
        <span itemprop="name">Home</span>
      </a>
    </li>

    <!-- site.pages links -->
    
    

    
      
      
    
      
      
        <li class="menu-item">
          <a href="/archive.html" itemprop="url">
            <span itemprop="name">Archive</span>
          </a>
        </li>
      
    
      
      
        <li class="menu-item">
          <a href="/bio.html" itemprop="url">
            <span itemprop="name">Bio</span>
          </a>
        </li>
      
    
      
      
    
      
      
        <li class="menu-item">
          <a href="/junit-4-with-hamcrest.html" itemprop="url">
            <span itemprop="name">JUnit 4 with Hamcrest</span>
          </a>
        </li>
      
    
      
      
        <li class="menu-item">
          <a href="/spock-intro-a-bdd-testing-framework-in-groovy.html" itemprop="url">
            <span itemprop="name">Spock Intro</span>
          </a>
        </li>
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
  </ul>
</nav>

        <ul class="contact-list">
  
    <li>
      <a href="mailto:ed@edgibbs.com">
        <span class="icon icon--email"><svg xmlns="http://www.w3.org/2000/svg" viewBox="313.1 3.7 16 16"><path d="M318.5 8.9c0-.2.2-.4.4-.4h4.5c.2 0 .4.2.4.4s-.2.4-.4.4h-4.5c-.3 0-.4-.2-.4-.4zm.4 2.1h4.5c.2 0 .4-.2.4-.4s-.2-.4-.4-.4h-4.5c-.2 0-.4.2-.4.4s.1.4.4.4zm3.5 1.2c0-.2-.2-.4-.4-.4h-3.1c-.2 0-.4.2-.4.4s.2.4.4.4h3.1c.2.1.4-.1.4-.4zm-1.5-8.4l-1.7 1.4c-.2.1-.2.4 0 .6s.4.2.6 0l1.4-1.2 1.4 1.2c.2.1.4.1.6 0s.1-.4 0-.6l-1.7-1.4c-.3-.1-.5-.1-.6 0zm7.8 6.2c.1.1.1.2.1.3v7.9c0 .8-.7 1.5-1.5 1.5h-12.5c-.8 0-1.5-.7-1.5-1.5v-7.9c0-.1.1-.2.1-.3l1.6-1.3c.2-.1.4-.1.6 0s.1.4 0 .6l-1.2 1 1.8 1.3v-4c0-.6.5-1.1 1.1-1.1h7.5c.6 0 1.1.5 1.1 1.1v4l1.8-1.3-1.2-1c-.2-.1-.2-.4 0-.6s.4-.2.6 0l1.6 1.3zm-11.6 2.2l4 2.8 4-2.8V7.6c0-.1-.1-.2-.2-.2h-7.5c-.1 0-.2.1-.2.2v4.6zm10.9-1l-4.7 3.4 3.4 2.6c.2.1.2.4.1.6-.1.2-.4.2-.6.1l-3.6-2.8-1.2.8c-.1.1-.3.1-.5 0l-1.2-.8-3.6 2.8c-.2.1-.4.1-.6-.1-.1-.2-.1-.4.1-.6l3.4-2.6-4.7-3.4v7.1c0 .4.3.6.6.6h12.5c.4 0 .6-.3.6-.6v-7.1z"/></svg></span>
        <span class="label">Email</span>
      </a>
    </li>
  

  
    <li><a href="https://github.com/edgibbs">
  <span class="icon icon--github"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M8 0C3.58 0 0 3.582 0 8c0 3.535 2.292 6.533 5.47 7.59.4.075.547-.172.547-.385 0-.19-.007-.693-.01-1.36-2.226.483-2.695-1.073-2.695-1.073-.364-.924-.89-1.17-.89-1.17-.725-.496.056-.486.056-.486.803.056 1.225.824 1.225.824.714 1.223 1.873.87 2.33.665.072-.517.278-.87.507-1.07-1.777-.2-3.644-.888-3.644-3.953 0-.873.31-1.587.823-2.147-.09-.202-.36-1.015.07-2.117 0 0 .67-.215 2.2.82.64-.178 1.32-.266 2-.27.68.004 1.36.092 2 .27 1.52-1.035 2.19-.82 2.19-.82.43 1.102.16 1.915.08 2.117.51.56.82 1.274.82 2.147 0 3.073-1.87 3.75-3.65 3.947.28.24.54.73.54 1.48 0 1.07-.01 1.93-.01 2.19 0 .21.14.46.55.38C13.71 14.53 16 11.53 16 8c0-4.418-3.582-8-8-8"/></svg></span>
  <span class="label">GitHub</span>
</a>
</li>
  

  
    <li><a href="https://www.linkedin.com/in/edwardgibbs">
  <span class="icon icon--linkedin"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51v1.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/></svg></span>
  <span class="label">LinkedIn</span>
</a>
</li>
  

  
    <li><a href="https://ruby.social/@edgibbs">
  <img src="/images/icon-mastodon.svg" alt="Mastodon" height=24 width=24 />
  <span class="label">Mastodon</span>
</a>
</li>
  

  
    <li><a href="https://twitter.com/edward_gibbs">
  <span class="icon icon--twitter"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M16 3.038c-.59.26-1.22.437-1.885.517.677-.407 1.198-1.05 1.443-1.816-.634.37-1.337.64-2.085.79-.598-.64-1.45-1.04-2.396-1.04-1.812 0-3.282 1.47-3.282 3.28 0 .26.03.51.085.75-2.728-.13-5.147-1.44-6.766-3.42C.83 2.58.67 3.14.67 3.75c0 1.14.58 2.143 1.46 2.732-.538-.017-1.045-.165-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.22-.276.074-.566.114-.865.114-.21 0-.41-.02-.61-.058.42 1.304 1.63 2.253 3.07 2.28-1.12.88-2.54 1.404-4.07 1.404-.26 0-.52-.015-.78-.045 1.46.93 3.18 1.474 5.04 1.474 6.04 0 9.34-5 9.34-9.33 0-.14 0-.28-.01-.42.64-.46 1.2-1.04 1.64-1.7z" fill-rule="nonzero"/></svg></span>
  <span class="label">Twitter</span>
</a>
</li>
  

  <li>
    
      <a href="/feed.xml" title="Atom Feed">
        <span class="icon icon--rss"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194 11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.99 2.194-2.2 2.194C.98 16 0 15.017 0 13.806c0-1.21.983-2.195 2.194-2.195zM10.606 16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"/></svg></span>
        <span class="label">Subscribe</span>
      </a>
    
  </li>
</ul>

      </div>
    </div>

    <div class="canvas">
      <div class="wrapper">
        

<header id="masthead">
  <div class="inner">
    <div class="title-area">
      
        <h1 class="site-title">
          <a href="/">
            <img src="/images/avatar.jpg" alt="" class="site-logo">
            <span>Musings of a Software Development Manager</span>
          </a>
        </h1>
      
    </div>
  </div>
</header>

        <div class="initial-content">
          


<main id="main" class="page-content" aria-label="Content">
  <div class="index inner">
    <div></div>

    <div>
      <div class="entries">
        
          
          
  

<article class="entry">
  <header class="entry-header">
    <h3 class="entry-title">
      <a href="/2024/12/21/given-when-then-versus-arrange-act-assert" rel="bookmark">Testing Patterns: Given-When-Then vs Arrange-Act-Assert
</a>
    </h3>
  </header>
  <footer class="entry-meta">
    <ul>
    
      <li><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="379 72 16 16"><g><g><path fill="none" d="M380.8,86.7h12.3v-8.8h-12.3V86.7z M389.5,78.8h1.7v1.4h-1.7V78.8z M389.5,81.3h1.7v1.4h-1.7V81.3z M389.5,83.8h1.7v1.4h-1.7V83.8z M386.1,78.8h1.7v1.4h-1.7V78.8z M386.1,81.3h1.7v1.4h-1.7V81.3z M386.1,83.8h1.7v1.4h-1.7V83.8z M382.8,78.8h1.7v1.4h-1.7V78.8z M382.8,81.3h1.7v1.4h-1.7V81.3z M382.8,83.8h1.7v1.4h-1.7V83.8z"/><polygon fill="none" points="384.7 75.1 383.4 75.1 383.4 74.3 380.8 74.3 380.8 76.6 393.2 76.6 393.2 74.3 390.6 74.3 390.6 75.1 389.3 75.1 389.3 74.3 384.7 74.3"/><rect x="382.8" y="78.8" width="1.7" height="1.4"/><rect x="386.1" y="78.8" width="1.7" height="1.4"/><rect x="389.5" y="78.8" width="1.7" height="1.4"/><rect x="382.8" y="81.3" width="1.7" height="1.4"/><rect x="386.1" y="81.3" width="1.7" height="1.4"/><rect x="389.5" y="81.3" width="1.7" height="1.4"/><rect x="382.8" y="83.8" width="1.7" height="1.4"/><rect x="386.1" y="83.8" width="1.7" height="1.4"/><rect x="389.5" y="83.8" width="1.7" height="1.4"/><path d="M383.4,72v1.1h-3.8V88h14.9V73.1h-3.8V72h-1.3v1.1h-4.7V72H383.4z M393.2,86.7h-12.3v-8.8h12.3L393.2,86.7L393.2,86.7z M389.3,74.3v0.8h1.3v-0.8h2.5v2.3h-12.3v-2.3h2.5v0.8h1.3v-0.8H389.3z"/></g></g></svg></span><time class="entry-time" datetime="2025-02-11T00:00:00+00:00">February 11, 2025</time></li>
    
    
    </ul>
  </footer>
  <div class="entry-excerpt">
      <p>Anecdotally I’ve recently noticed an uptick in presenting the AAA pattern for writing good tests. Most of my career I’ve thought about this from the <a href="https://martinfowler.com/bliki/GivenWhenThen.html">Given/When/Then</a> paradigm. My assumption much like the dominance of RSpec in Ruby was that was the common explanation/mnemonic when describing how to layout tests. The only other pattern I had a sense of was the old xUnit idea based around its minimalist methods:</p>

<ul>
  <li>setup</li>
  <li>assert</li>
  <li>teardown</li>
</ul>

<p>Given/When/Then was such a default that Jim Weyrich even created his own testing framework based on it, <a href="https://github.com/jimweirich/rspec-given">rspec-given</a>.  It comes out of the BDD movement where the focus was to not get so focused on the mechanics of testing, but more on the value of specifying expectations up front before writing the code to implement the tests. Gherkin sprouted out of this and it was further solidified by being built into tools like Cucumber and RSpec Given.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">describe</span> <span class="no">Formatter</span>
  <span class="n">describe</span> <span class="s2">"#add_emojis"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"adds emojis to the string"</span> <span class="k">do</span>
      <span class="c1"># Given</span>
      <span class="n">formatter</span> <span class="o">=</span> <span class="no">Formatter</span><span class="p">.</span><span class="nf">new</span>
      <span class="n">string</span> <span class="o">=</span> <span class="s2">"Hello, World!"</span>

      <span class="c1"># When</span>
      <span class="n">formatted_string</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">.</span><span class="nf">add_emojis</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>

      <span class="c1"># Then</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">formatted_string</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="s2">"👋, 🌎!"</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Apparently <a href="https://xp123.com/3a-arrange-act-assert/">AAA</a> was coined way back in the fairly early XP days by Bill Wake. Reading through his reasoning I appreciate that he was trying to define the steps as:</p>

<ol>
  <li><strong>Arrange</strong> -&gt; setup the collaborating object, mocks and construct the object</li>
  <li><strong>Act</strong> -&gt; actually perform an action usually calling a method or function</li>
  <li><strong>Assert</strong> -&gt; make the assertions</li>
</ol>

<p>When actually writing these he mentions that a TDD/BDD approach he favors is actually to sort of reverse the order for writing a test as:</p>

<ol>
  <li><strong>Assert</strong> -&gt; write this first because you’re trying to think about what the object should actually do (Test Driven Design)</li>
  <li><strong>Arrange</strong> -&gt; now you have an idea of what you need to setup the object</li>
  <li><strong>Act</strong> -&gt; actually call the method/function</li>
</ol>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">describe</span> <span class="no">ShoppingCart</span> <span class="k">do</span>
  <span class="n">describe</span> <span class="s2">"#total"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"updates the total when adding a book"</span> <span class="k">do</span>
      <span class="c1"># Arrange</span>
      <span class="n">cart</span> <span class="o">=</span> <span class="no">ShoppingCart</span><span class="p">.</span><span class="nf">new</span>
      <span class="n">keycaps</span> <span class="o">=</span> <span class="no">Product</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"Emoji Keycaps"</span><span class="p">,</span> <span class="ss">unit_price: </span><span class="no">Currency</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mf">59.99</span><span class="p">,</span> <span class="s2">"USD"</span><span class="p">))</span>
      <span class="n">switch</span> <span class="o">=</span> <span class="no">Product</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"Clicky Switches"</span><span class="p">,</span> <span class="ss">unit_price: </span><span class="no">Currency</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mf">0.27</span><span class="p">,</span> <span class="s2">"USD"</span><span class="p">))</span>

      <span class="c1"># Act</span>
      <span class="n">cart</span><span class="p">.</span><span class="nf">add_item</span><span class="p">(</span><span class="n">keycaps</span><span class="p">)</span>
      <span class="mi">75</span><span class="p">.</span><span class="nf">times</span> <span class="k">do</span>
        <span class="n">cart</span><span class="p">.</span><span class="nf">add_item</span><span class="p">(</span><span class="n">switch</span><span class="p">)</span>
      <span class="k">end</span>

      <span class="c1"># Assert</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">cart</span><span class="p">.</span><span class="nf">total</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="mf">80.24</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>
<p>I’m still sold on the nice rhyming structure of Given/When/Then as easy to remember and a little nicer sounding. People often shortcut to the <code class="language-plaintext highlighter-rouge">AAA</code> pattern and it becomes easy to forget what it’s trying to remind you of. As I get further in my career I find it encouraging from the early days of TDD where trying to get people to even think about writing a test was a long often fruitless discussion. Nowadays I have time to think about very small aspects of testing like helpful shortcuts to remember the common testing patterns.</p>

  </div>
</article>


  

<article class="entry">
  <header class="entry-header">
    <h3 class="entry-title">
      <a href="/2024/06/23/" rel="bookmark">Inline setup versus let in RSpec
</a>
    </h3>
  </header>
  <footer class="entry-meta">
    <ul>
    
      <li><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="379 72 16 16"><g><g><path fill="none" d="M380.8,86.7h12.3v-8.8h-12.3V86.7z M389.5,78.8h1.7v1.4h-1.7V78.8z M389.5,81.3h1.7v1.4h-1.7V81.3z M389.5,83.8h1.7v1.4h-1.7V83.8z M386.1,78.8h1.7v1.4h-1.7V78.8z M386.1,81.3h1.7v1.4h-1.7V81.3z M386.1,83.8h1.7v1.4h-1.7V83.8z M382.8,78.8h1.7v1.4h-1.7V78.8z M382.8,81.3h1.7v1.4h-1.7V81.3z M382.8,83.8h1.7v1.4h-1.7V83.8z"/><polygon fill="none" points="384.7 75.1 383.4 75.1 383.4 74.3 380.8 74.3 380.8 76.6 393.2 76.6 393.2 74.3 390.6 74.3 390.6 75.1 389.3 75.1 389.3 74.3 384.7 74.3"/><rect x="382.8" y="78.8" width="1.7" height="1.4"/><rect x="386.1" y="78.8" width="1.7" height="1.4"/><rect x="389.5" y="78.8" width="1.7" height="1.4"/><rect x="382.8" y="81.3" width="1.7" height="1.4"/><rect x="386.1" y="81.3" width="1.7" height="1.4"/><rect x="389.5" y="81.3" width="1.7" height="1.4"/><rect x="382.8" y="83.8" width="1.7" height="1.4"/><rect x="386.1" y="83.8" width="1.7" height="1.4"/><rect x="389.5" y="83.8" width="1.7" height="1.4"/><path d="M383.4,72v1.1h-3.8V88h14.9V73.1h-3.8V72h-1.3v1.1h-4.7V72H383.4z M393.2,86.7h-12.3v-8.8h12.3L393.2,86.7L393.2,86.7z M389.3,74.3v0.8h1.3v-0.8h2.5v2.3h-12.3v-2.3h2.5v0.8h1.3v-0.8H389.3z"/></g></g></svg></span><time class="entry-time" datetime="2024-06-23T00:00:00+00:00">June 23, 2024</time></li>
    
    
    </ul>
  </footer>
  <div class="entry-excerpt">
      <p><code class="language-plaintext highlighter-rouge">let</code> has a long history in RSpec having been introduced with a <a href="https://github.com/rspec/rspec-core/commit/4d67748f">commit</a> in 2009 and rolled out as
part of RSpec 2. I adopted it early on as the aesthetics appealed to me with <code class="language-plaintext highlighter-rouge">let</code> variables being defined first in little blocks with symbols. One of
our engineers wrote a macro in vim to quickly hoist instance variables in older style RSpec tests to let declarations. It became the default
style for everyone in RSpec with only a bit of controversy around <code class="language-plaintext highlighter-rouge">let!</code> which could be easy to miss in tests. I knew about the lazy initialization, but
it was the aesthetics I prized.</p>

<p>I remember a bit of a community debate a few years later with a famous Thoughtbot blog post entitled <a href="https://robots.thoughtbot.com/lets-not">Let’s
Not</a>. It argued pretty convincingly that let was a mystery guest pattern which you don’t want when writng
clear tests. Since our team’s default at that point was to use let, but we wrote pretty small Sandi Metz style classes with a single responsibility,
the <code class="language-plaintext highlighter-rouge">let</code>s weren’t causing a big headache. If the code and the specs were visible in a single editor window, it was easy to see what was going on.</p>

<p>Fast forward to working on one of the largest Ruby codebases in the world and I got reintroduced to the idea of containing the entire test inline.
Much of the codebase doesn’t fit in a single editor window and suddenly those little <code class="language-plaintext highlighter-rouge">let</code>s are screens away and hard to find. Add with nested contexts,
shared examples and the like I was really hating <code class="language-plaintext highlighter-rouge">let</code>. Some of the more painful specs potentially executed up to 100 <code class="language-plaintext highlighter-rouge">let</code>s before running an
individual spec and often fired hundreds of SQL queries. I continued to use it on newer refactored code, but eventually the team started to cut
back to allowing fewer lets in a given spec as a compromise. Today my default is to write the entire context of the test inline with no <code class="language-plaintext highlighter-rouge">let</code>s at all.</p>

<p>So a let heavy spec like the following is forced into:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">BlogPost</span> <span class="k">do</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:author</span><span class="p">)</span> <span class="p">{</span> <span class="no">Author</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"Gunther Hemingway"</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:editor</span><span class="p">)</span> <span class="p">{</span> <span class="no">Editor</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"Jordon Adams"</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:category</span><span class="p">)</span> <span class="p">{</span> <span class="no">Category</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"technology"</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:comments</span><span class="p">)</span> <span class="k">do</span>
    <span class="p">[</span>
      <span class="no">Comment</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">author: </span><span class="s2">"hank"</span><span class="p">,</span> <span class="ss">content: </span><span class="s2">"great post!"</span><span class="p">),</span>
      <span class="no">Comment</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">author: </span><span class="s2">"lisa"</span><span class="p">,</span> <span class="ss">content: </span><span class="s2">"very informative."</span><span class="p">),</span>
    <span class="p">]</span>
  <span class="k">end</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:tags</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="s2">"ruby"</span><span class="p">,</span> <span class="s2">"software development"</span><span class="p">,</span> <span class="s2">"tdd"</span><span class="p">]</span> <span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:blog_post</span><span class="p">)</span> <span class="k">do</span>
    <span class="no">BlogPost</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
      <span class="ss">title: </span><span class="s2">"rspec and let"</span><span class="p">,</span>
      <span class="ss">content: </span><span class="s2">"using let in rspec can help with..."</span><span class="p">,</span>
      <span class="ss">author: </span><span class="n">author</span><span class="p">,</span>
      <span class="ss">editor: </span><span class="n">editor</span><span class="p">,</span>
      <span class="ss">category: </span><span class="n">category</span><span class="p">,</span>
      <span class="ss">comments: </span><span class="n">comments</span><span class="p">,</span>
      <span class="ss">tags: </span><span class="n">tags</span>
    <span class="p">)</span>
  <span class="k">end</span>

  <span class="n">describe</span> <span class="s2">"#publish"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"notifies the author and editor when published"</span> <span class="k">do</span>
      <span class="n">blog_post</span><span class="p">.</span><span class="nf">publish</span>

      <span class="n">expect</span><span class="p">(</span><span class="n">author</span><span class="p">.</span><span class="nf">notifications</span><span class="p">.</span><span class="nf">last</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="s2">"your post 'rspec and let' has been published."</span><span class="p">)</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">editor</span><span class="p">.</span><span class="nf">notifications</span><span class="p">.</span><span class="nf">last</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="s2">"the post 'rspec and let' you edited has been published."</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This much more explict style:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">describe</span> <span class="no">BlogPost</span> <span class="k">do</span>
  <span class="n">describe</span> <span class="s2">"#publish"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s2">"notifies the author and editor when published"</span> <span class="k">do</span>
      <span class="n">blog_post</span> <span class="o">=</span> <span class="no">BlogPost</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span>
        <span class="ss">title: </span><span class="s2">"rspec and let"</span><span class="p">,</span>
        <span class="ss">content: </span><span class="s2">"using let in rspec can help with..."</span><span class="p">,</span>
        <span class="ss">author: </span><span class="no">Author</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"Gunther Hemingway"</span><span class="p">)</span>
        <span class="ss">editor: </span><span class="no">Editor</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"Jordon Adams"</span><span class="p">)</span>
        <span class="ss">category: </span><span class="n">category</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">name: </span><span class="s2">"technology"</span><span class="p">),</span>
        <span class="ss">comments: </span><span class="p">[</span>
          <span class="n">comment</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">author: </span><span class="s2">"leslie"</span><span class="p">,</span> <span class="ss">content: </span><span class="s2">"great post!"</span><span class="p">),</span>
          <span class="n">comment</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">author: </span><span class="s2">"bob"</span><span class="p">,</span> <span class="ss">content: </span><span class="s2">"very informative."</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="ss">tags: </span><span class="p">[</span><span class="s2">"ruby"</span><span class="p">,</span> <span class="s2">"software development"</span><span class="p">,</span> <span class="s2">"tdd"</span><span class="p">]</span>
      <span class="p">)</span>

      <span class="n">blog_post</span><span class="p">.</span><span class="nf">publish</span>

      <span class="n">expect</span><span class="p">(</span><span class="n">blog_post</span><span class="p">.</span><span class="nf">author</span><span class="p">.</span><span class="nf">notifications</span><span class="p">.</span><span class="nf">last</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="s2">"your post 'rspec and let' has been published."</span><span class="p">)</span>
      <span class="n">expect</span><span class="p">(</span><span class="n">blog_post</span><span class="p">.</span><span class="nf">editor</span><span class="p">.</span><span class="nf">notifications</span><span class="p">.</span><span class="nf">last</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span><span class="p">(</span><span class="s2">"the post 'rspec and let' you edited has been published."</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Inline default leads to several happy impacts:</p>

<ul>
  <li>If you ever need to move this spec, copy it as a starting point, etc, it’s all intact as a single unit</li>
  <li>Sure you’ll probably duplicate some of this for a second spec, but deep in a spec file you’ll never need to scroll around to see what’s going on</li>
  <li>If your setup code looks like many lines of boilerplate perhaps your class has way to many dependencies and needs reactoring</li>
</ul>

<p>So if you haven’t tried this recently I’d invite you to do an experiment for a week and write zero <code class="language-plaintext highlighter-rouge">let</code>s.</p>

  </div>
</article>


  

<article class="entry">
  <header class="entry-header">
    <h3 class="entry-title">
      <a href="/2024/01/10/checkout-online-coding-environments-before-the-interview/" rel="bookmark">Interview Tip: Checkout Online Code Environments before the Interview
</a>
    </h3>
  </header>
  <footer class="entry-meta">
    <ul>
    
      <li><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="379 72 16 16"><g><g><path fill="none" d="M380.8,86.7h12.3v-8.8h-12.3V86.7z M389.5,78.8h1.7v1.4h-1.7V78.8z M389.5,81.3h1.7v1.4h-1.7V81.3z M389.5,83.8h1.7v1.4h-1.7V83.8z M386.1,78.8h1.7v1.4h-1.7V78.8z M386.1,81.3h1.7v1.4h-1.7V81.3z M386.1,83.8h1.7v1.4h-1.7V83.8z M382.8,78.8h1.7v1.4h-1.7V78.8z M382.8,81.3h1.7v1.4h-1.7V81.3z M382.8,83.8h1.7v1.4h-1.7V83.8z"/><polygon fill="none" points="384.7 75.1 383.4 75.1 383.4 74.3 380.8 74.3 380.8 76.6 393.2 76.6 393.2 74.3 390.6 74.3 390.6 75.1 389.3 75.1 389.3 74.3 384.7 74.3"/><rect x="382.8" y="78.8" width="1.7" height="1.4"/><rect x="386.1" y="78.8" width="1.7" height="1.4"/><rect x="389.5" y="78.8" width="1.7" height="1.4"/><rect x="382.8" y="81.3" width="1.7" height="1.4"/><rect x="386.1" y="81.3" width="1.7" height="1.4"/><rect x="389.5" y="81.3" width="1.7" height="1.4"/><rect x="382.8" y="83.8" width="1.7" height="1.4"/><rect x="386.1" y="83.8" width="1.7" height="1.4"/><rect x="389.5" y="83.8" width="1.7" height="1.4"/><path d="M383.4,72v1.1h-3.8V88h14.9V73.1h-3.8V72h-1.3v1.1h-4.7V72H383.4z M393.2,86.7h-12.3v-8.8h12.3L393.2,86.7L393.2,86.7z M389.3,74.3v0.8h1.3v-0.8h2.5v2.3h-12.3v-2.3h2.5v0.8h1.3v-0.8H389.3z"/></g></g></svg></span><time class="entry-time" datetime="2024-01-10T00:00:00+00:00">January 10, 2024</time></li>
    
    
    </ul>
  </footer>
  <div class="entry-excerpt">
      <p>Live coding is a stressful experience. One of the simplest ways to reduce stress around solving a
unknown problem in less than an hour is to setup your environment before the interview. My anecdotal experience is that
so few developers do this in practice. As an interviewer its a good sign when you check the coding environment
before and see the candidate has already setup the environment and got a test up and running.</p>

<p>It’s a signal to the interviewer of several things in the interview:</p>

<ul>
  <li>You are naturally prepared</li>
  <li>You are able to take full advantage of any tools/libraries provided</li>
  <li>You are pretty motivated to work for this organization</li>
</ul>

<p>Using <a href="https://coderpad.io">CoderPad</a> as an example:</p>

<ul>
  <li>You can login ahead of time into the pad setup for your interview or at least login to CoderPad’s site and try out a sandbox.</li>
  <li>Select a few of the coding environments you are most comfortable with. Unless you are forced into a specific language always choose your day-to-day language.</li>
  <li>See what libraries you have access to like RSpec, ActiveSupport in Ruby for example.</li>
  <li>Look at the settings for including important things like vim/emac support, Intellisense, etc.</li>
  <li>Get a test running in the environment, so you can TDD right away using your favorite testing framework or at least an available one.</li>
  <li>Test drive a simple problem in the space like FizzBuzz just to get a feel for the environment and how it works.</li>
  <li>If this is the actual coding environment for the interview leave your code in there for the interviewer to discover.</li>
</ul>

<p>I know I see this level of preperation maybe 5-10% of the time, so it’s an easy way to start off strong.</p>


  </div>
</article>


  

<article class="entry">
  <header class="entry-header">
    <h3 class="entry-title">
      <a href="/2022/08/01/quick-inline-vim-keymap-shortcut/" rel="bookmark">Quick Inline Vim Keymap Shortcut
</a>
    </h3>
  </header>
  <footer class="entry-meta">
    <ul>
    
      <li><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="379 72 16 16"><g><g><path fill="none" d="M380.8,86.7h12.3v-8.8h-12.3V86.7z M389.5,78.8h1.7v1.4h-1.7V78.8z M389.5,81.3h1.7v1.4h-1.7V81.3z M389.5,83.8h1.7v1.4h-1.7V83.8z M386.1,78.8h1.7v1.4h-1.7V78.8z M386.1,81.3h1.7v1.4h-1.7V81.3z M386.1,83.8h1.7v1.4h-1.7V83.8z M382.8,78.8h1.7v1.4h-1.7V78.8z M382.8,81.3h1.7v1.4h-1.7V81.3z M382.8,83.8h1.7v1.4h-1.7V83.8z"/><polygon fill="none" points="384.7 75.1 383.4 75.1 383.4 74.3 380.8 74.3 380.8 76.6 393.2 76.6 393.2 74.3 390.6 74.3 390.6 75.1 389.3 75.1 389.3 74.3 384.7 74.3"/><rect x="382.8" y="78.8" width="1.7" height="1.4"/><rect x="386.1" y="78.8" width="1.7" height="1.4"/><rect x="389.5" y="78.8" width="1.7" height="1.4"/><rect x="382.8" y="81.3" width="1.7" height="1.4"/><rect x="386.1" y="81.3" width="1.7" height="1.4"/><rect x="389.5" y="81.3" width="1.7" height="1.4"/><rect x="382.8" y="83.8" width="1.7" height="1.4"/><rect x="386.1" y="83.8" width="1.7" height="1.4"/><rect x="389.5" y="83.8" width="1.7" height="1.4"/><path d="M383.4,72v1.1h-3.8V88h14.9V73.1h-3.8V72h-1.3v1.1h-4.7V72H383.4z M393.2,86.7h-12.3v-8.8h12.3L393.2,86.7L393.2,86.7z M389.3,74.3v0.8h1.3v-0.8h2.5v2.3h-12.3v-2.3h2.5v0.8h1.3v-0.8H389.3z"/></g></g></svg></span><time class="entry-time" datetime="2022-08-01T00:00:00+00:00">August 1, 2022</time></li>
    
    
    </ul>
  </footer>
  <div class="entry-excerpt">
      <p>I often forget the exact syntax for writing a quick shortcut in in vim/neovim. After hunting for several minutes
this morning I made a decision to memorialize the approach. Usually it’s for a simple command like running tests in
an Elixir mix console:</p>

<figure class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="p">:</span>nnoremap <span class="p">,</span><span class="k">e</span> <span class="p">:!</span>mix test<span class="p">&lt;</span>CR<span class="p">&gt;</span></code></pre></figure>

<p>So the first <code class="language-plaintext highlighter-rouge">n</code> means it applies just to normal mode. The <code class="language-plaintext highlighter-rouge">noremap</code> means it won’t follow any other mapping so it’s
non-recursive. The <code class="language-plaintext highlighter-rouge">,e</code> is the what the shortcut is mapped to. And finally the <code class="language-plaintext highlighter-rouge">:!mix test&lt;CR&gt;</code> puts the mix command
into the terminal and hits a carriage return to execute the command.</p>

  </div>
</article>


  

<article class="entry">
  <header class="entry-header">
    <h3 class="entry-title">
      <a href="/2022/04/17/aggregate-failures/" rel="bookmark">Aggregate Failures
</a>
    </h3>
  </header>
  <footer class="entry-meta">
    <ul>
    
      <li><span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="379 72 16 16"><g><g><path fill="none" d="M380.8,86.7h12.3v-8.8h-12.3V86.7z M389.5,78.8h1.7v1.4h-1.7V78.8z M389.5,81.3h1.7v1.4h-1.7V81.3z M389.5,83.8h1.7v1.4h-1.7V83.8z M386.1,78.8h1.7v1.4h-1.7V78.8z M386.1,81.3h1.7v1.4h-1.7V81.3z M386.1,83.8h1.7v1.4h-1.7V83.8z M382.8,78.8h1.7v1.4h-1.7V78.8z M382.8,81.3h1.7v1.4h-1.7V81.3z M382.8,83.8h1.7v1.4h-1.7V83.8z"/><polygon fill="none" points="384.7 75.1 383.4 75.1 383.4 74.3 380.8 74.3 380.8 76.6 393.2 76.6 393.2 74.3 390.6 74.3 390.6 75.1 389.3 75.1 389.3 74.3 384.7 74.3"/><rect x="382.8" y="78.8" width="1.7" height="1.4"/><rect x="386.1" y="78.8" width="1.7" height="1.4"/><rect x="389.5" y="78.8" width="1.7" height="1.4"/><rect x="382.8" y="81.3" width="1.7" height="1.4"/><rect x="386.1" y="81.3" width="1.7" height="1.4"/><rect x="389.5" y="81.3" width="1.7" height="1.4"/><rect x="382.8" y="83.8" width="1.7" height="1.4"/><rect x="386.1" y="83.8" width="1.7" height="1.4"/><rect x="389.5" y="83.8" width="1.7" height="1.4"/><path d="M383.4,72v1.1h-3.8V88h14.9V73.1h-3.8V72h-1.3v1.1h-4.7V72H383.4z M393.2,86.7h-12.3v-8.8h12.3L393.2,86.7L393.2,86.7z M389.3,74.3v0.8h1.3v-0.8h2.5v2.3h-12.3v-2.3h2.5v0.8h1.3v-0.8H389.3z"/></g></g></svg></span><time class="entry-time" datetime="2022-04-17T00:00:00+00:00">April 17, 2022</time></li>
    
    
    </ul>
  </footer>
  <div class="entry-excerpt">
      <p>After working on several large rails codebases in the last 10 years I’ve seen a familiar pattern.
Many tests in Rails projects are integration tests because they rely on actual database objects existing.
One assertion per test is great rule when you don’t have tens of thousands of specs running. <code class="language-plaintext highlighter-rouge">:aggregate-failures</code>
allows you to have multiple assertions while still reporting on each failure clearly.</p>

<p>As a bonus it is honored by <code class="language-plaintext highlighter-rouge">Rubocop RSpec RSpec/MultipleExpectations</code>. Not sure why this isn’t
documented better with Rubocop RSpec. Here is the code within the <code class="language-plaintext highlighter-rouge">MultipleExpectations</code> class that
enforces the one assert per spec rule:</p>

<p><a href="https://github.com/rubocop/rubocop-rspec/blob/master/lib/rubocop/cop/rspec/multiple_expectations.rb">MultipleExpectations</a></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">on_block</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
  <span class="k">return</span> <span class="k">unless</span> <span class="n">example?</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

  <span class="k">return</span> <span class="k">if</span> <span class="n">example_with_aggregate_failures?</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

  <span class="n">expectations_count</span> <span class="o">=</span> <span class="n">to_enum</span><span class="p">(</span><span class="ss">:find_expectation</span><span class="p">,</span> <span class="n">node</span><span class="p">).</span><span class="nf">count</span>

  <span class="k">return</span> <span class="k">if</span> <span class="n">expectations_count</span> <span class="o">&lt;=</span> <span class="n">max_expectations</span>

  <span class="nb">self</span><span class="p">.</span><span class="nf">max</span> <span class="o">=</span> <span class="n">expectations_count</span>

  <span class="n">flag_example</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="ss">expectation_count: </span><span class="n">expectations_count</span><span class="p">)</span>
<span class="k">end</span></code></pre></figure>

<p>And you don’t need to feel guilty about adding aggregate failures:</p>

<ul>
  <li>It speeds up test runs because it doesn’t do multiple setups</li>
  <li>By default anything that uses ActiveRecord is not a true unit test</li>
  <li>You still get all the errors if multiple lines fail</li>
  <li>Speed of test run on any significant Rails project should almost always win</li>
</ul>

  </div>
</article>



<!-- Pagination links -->
<nav class="pager">
  <ul>
    <!-- Page: 1 of 152 -->
    
    
      <li><a href="/page2/" class="next">Older <span class="icon icon--arrow-right"><svg xmlns="http://www.w3.org/2000/svg" viewBox="50.4 -114.8 16 16"><path d="M63.1-107.7l-6.7-6.7c-.2-.3-.6-.4-.9-.4-.4 0-.7.1-.9.4l-.8.8c-.3.3-.4.6-.4.9 0 .4.1.7.4.9l5 5-5 5c-.3.3-.4.6-.4.9 0 .4.1.7.4.9l.8.8c.3.3.6.4.9.4.4 0 .7-.1.9-.4l6.7-6.7c.3-.3.4-.6.4-.9 0-.4-.2-.7-.4-.9z"/></svg></span></a></li>
    
  </ul>
</nav>
        
      </div>
    </div>

    <footer id="footer" class="site-footer">
  <div class="inner">
    <div class="copyright">
      
        <p>&copy; 2025 Musings of a Software Development Manager.</p>
      
    </div>
  </div>
</footer>

  </div>
</main>

        </div>

        <div class="search-content">
          <div class="inner">
  
</div>

        </div>
      </div>
    </div>

    

<script async src="/assets/javascripts/main.js"></script>




  </body>

</html>
